<div class="app-stepper-container" *transloco="let t">
  <div class="app-stepper-header">
    <div style="flex: 1">
      <h5 style="font-size: 1.2rem; margin-bottom: 0.5rem">
        {{ t("startReport") }}
      </h5>
      <!-- <span>
        {{ t("project") }}: {{ project?.name }} ({{ project?.id }})
      </span> -->
    </div>
    <div>
      <div class="header-actions">
        <button mat-stroked-button color="primary" (click)="goBack()">
          {{ t("exitForm") }}
        </button>
      </div>
      <!-- <div class="save-info">
        <div style="display: flex; flex-direction: row; gap: 1rem">
          <i *ngIf="autoSaveCountdown <= 30 && autoSaveCountdown > 0"
            >Saving in {{ autoSaveCountdown }}
            {{ autoSaveCountdown === 1 ? "second" : "seconds" }}...
          </i>
          <i
            *ngIf="
              lastSavedAt && (autoSaveCountdown === 0 || autoSaveCountdown > 30)
            "
            >Saved at {{ lastSavedAt | date : "mediumTime" }}</i
          >
        </div>
      </div> -->
    </div>
  </div>
  <mat-stepper
    class="app-stepper"
    [linear]="true"
    labelPosition="bottom"
    (selectionChange)="stepperSelectionChange($event)"
    [orientation]="stepperOrientation"
    #stepper
  >
    <mat-step
      label="Select Report"
      [stepControl]="getConfigurationForm()"
      [optional]="false"
    >
      <div style="display: flex; flex-direction: column; gap: 1rem">
        <mat-label> Select the type of report you want to create: </mat-label>
        <!-- radio button -->
        <drr-select
          style="align-self: flex-start; width: 25rem"
          [label]="t('reportType')"
          [rxFormControl]="getConfigurationForm().get('periodType')"
          [options]="periodTypeOptions"
        ></drr-select>
      </div>
      <div class="drr-stepper-action">
        <button
          id="next1"
          mat-flat-button
          color="primary"
          matStepperNext
          type="button"
        >
          {{ t("next") }}
        </button>
      </div>
    </mat-step>
    <mat-step label="Confirm OR Contact">
      <div style="display: flex; flex-direction: column; gap: 1rem">
        <ng-container
          [ngSwitch]="interimReportForm.get('configuration.periodType')?.value"
        >
          <div *ngSwitchCase="'Interim'">
            @if (canCreateReportResult?.canCreate) {
              <p>
                This will create the
                {{ canCreateReportResult?.description }} interim report. Do you
                want to proceed?
              </p>
            } @else {
              <p>
                A new interim report cannot be created until the previous report
                is approved.
              </p>
            }
          </div>
          <div *ngSwitchCase="'OffCycle'">
            <mat-label class="drr-label"
              >You're about to create an off-cycle report</mat-label
            >
            <p>
              <i>
                An off-cycle report is a report that is submitted outside of the
                regular reporting schedule. It is used to provide an update on
                the project progress and to request additional funding if
                needed.
              </i>
            </p>
          </div>
          <div *ngSwitchCase="'Final'">
            <mat-label class="drr-label"
              >You're about to create a final report</mat-label
            >
            <p>
              <i>
                A final report is a report that is submitted at the end of the
                project cycle. It is used to provide a summary of the project
                outcomes and to request final payment.
              </i>
            </p>
          </div>
          <div *ngSwitchCase="'Skip'">
            <mat-label class="drr-label"
              >You're about to skip the interim report</mat-label
            >
            <p>
              <i>
                You've chosen to skip the report creation. This means that you
                will not be able to submit a report for this period.
              </i>
            </p>
          </div>
        </ng-container>
      </div>
      <div class="drr-stepper-actions">
        <button mat-stroked-button color="primary" matStepperPrevious>
          {{ t("back") }}
        </button>
        <button
          id="next2"
          mat-flat-button
          color="primary"
          matStepperNext
          type="button"
        >
          {{ canCreateReportResult?.canCreate ? t("create") : t("close") }}
        </button>
      </div></mat-step
    >
  </mat-stepper>
</div>
